<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Neo4J - My First Commands - All about Databases</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://databaseblog.github.io/neo4j-my-first-commands.html">

        <meta name="author" content="Graham Cox <graham@grahamcox.co.uk>" />
        <meta name="description" content="Once you&#39;ve got access to a Neo4J instance, you&#39;re going to want to do something with it. It&#39;s not much use otherwise. This will show some very basic commands, and show what you can expect to get out of this system with virtually no effort. All of the examples here …" />

        <meta property="og:site_name" content="All about Databases" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Neo4J - My First Commands"/>
        <meta property="og:url" content="https://databaseblog.github.io/neo4j-my-first-commands.html"/>
        <meta property="og:description" content="Once you&#39;ve got access to a Neo4J instance, you&#39;re going to want to do something with it. It&#39;s not much use otherwise. This will show some very basic commands, and show what you can expect to get out of this system with virtually no effort. All of the examples here …"/>
        <meta property="article:published_time" content="2017-03-28" />
            <meta property="article:section" content="neo4j" />
            <meta property="article:author" content="Graham Cox <graham@grahamcox.co.uk>" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://databaseblog.github.io/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://databaseblog.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://databaseblog.github.io/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://databaseblog.github.io/theme/css/style.css" type="text/css"/>

        <link href="https://databaseblog.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="All about Databases ATOM Feed"/>



        <link href="https://databaseblog.github.io/feeds/neo4j.atom.xml" type="application/atom+xml" rel="alternate"
              title="All about Databases neo4j ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://databaseblog.github.io/" class="navbar-brand">
All about Databases            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="https://databaseblog.github.io/category/misc.html">Misc</a>
                        </li>
                        <li class="active">
                            <a href="https://databaseblog.github.io/category/neo4j.html">Neo4j</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="https://databaseblog.github.io" title="All about Databases"><i class="fa fa-home fa-lg"></i></a></li>
                <li class="active">Neo4J - My First Commands</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://databaseblog.github.io/neo4j-my-first-commands.html"
                       rel="bookmark"
                       title="Permalink to Neo4J - My First Commands">
                        Neo4J - My First Commands
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-03-28T12:54:00+01:00"> Tue 28 March 2017</time>
    </span>





    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Once you've got access to a Neo4J instance, you're going to want to do something with it. It's not much use otherwise. This will show some very basic commands, and show what you can expect to get out of this system with virtually no effort.</p>
<p>All of the examples here are going to be using the command line <code>cypher-shell</code> simply because it renders better in text form. You can do everything in the Web UI as well.</p>
<h3>Creating a node</h3>
<p>Creating a node can be achieved using the <code>CREATE</code> command. </p>
<div class="highlight"><pre><span></span>neo4j&gt; CREATE (n);
Added 1 nodes
</pre></div>


<p>This creates a new Node, with no properties or labels associated with it. It's pretty boring, but it works. Note that the definition of the Node is wrapped in parenthesis. Every time you declare a Node you will do this.</p>
<p>A more interesting node would be one with a Label, and some associated data. Let's create a User record for some made up game.</p>
<div class="highlight"><pre><span></span><span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">CREATE</span> <span class="o">(</span><span class="nt">u</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span><span class="s1">&#39;graham&#39;</span><span class="p">}</span><span class="o">);</span>
<span class="nt">Added</span> <span class="nt">1</span> <span class="nt">nodes</span><span class="o">,</span> <span class="nt">Set</span> <span class="nt">1</span> <span class="nt">properties</span><span class="o">,</span> <span class="nt">Added</span> <span class="nt">1</span> <span class="nt">labels</span>
</pre></div>


<p>There. It really is that simple.</p>
<p>Note that this breaks down into a number of parts, as follows:</p>
<ul>
<li><code>CREATE</code> - This is the command being executed</li>
<li><code>u</code> - This is just a local tag for this command to represent this node. It must be unique, but it doesn't matter what it is.</li>
<li><code>:User</code> - This is a Label associated with the newly created Node</li>
<li><code>{username:'graham'}</code> - This is the properties of the node</li>
</ul>
<h3>Retrieving a node</h3>
<p>Once a node has been created, you can then retrieve it. This is done with the MATCH command.</p>
<div class="highlight"><pre><span></span>neo4j&gt; MATCH (n) RETURN n;
n
()
(:User {username: &quot;graham&quot;})
</pre></div>


<p>This output is not the most obvious to read, but it displays two Nodes that were returned - the two that we've just created. The first one has no labels and no properties, and the second has a single label - User - and a single property - username: "graham".</p>
<p>This can be extended to match on certain criteria, by specifying it in the nodes that you want to match. For example:</p>
<div class="highlight"><pre><span></span><span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">n</span><span class="p">:</span><span class="nd">User</span><span class="o">)</span> <span class="nt">RETURN</span> <span class="nt">n</span><span class="o">;</span>
<span class="nt">n</span>
<span class="o">(</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span>

<span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">n</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span> <span class="nt">RETURN</span> <span class="nt">n</span><span class="o">;</span>
<span class="nt">n</span>
<span class="o">(</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span>

<span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">n</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span> <span class="nt">RETURN</span> <span class="nt">n</span><span class="o">;</span>
<span class="nt">n</span>
<span class="o">(</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span>
</pre></div>


<p>Two different queries, matching in two different ways, but both return the same one node. The first of these queries will return all nodes that have a label of "User", but doesn't care about any other data. The second of these will return all nodes that have a property of "username" that has a value of "graham", but also doesn't care about any other data. These can of course be combined as much as needed to get the matches you want.</p>
<p>This is all very good, but it only gives a very limited support for matching. We can match on exactly the data we want being present, but nothing more complicated. For this we can make use of the WHERE clause to the MATCH command. This gives us full boolean logic for complete matching control, the same as in any other database engihe. However, this can be very powerful when we start doing matching across multiple nodes as we will later see.</p>
<p>For a simple example here, we can re-write the above queries using the WHERE clause as follows:</p>
<div class="highlight"><pre><span></span><span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">n</span><span class="o">)</span> <span class="nt">WHERE</span> <span class="nt">n</span><span class="p">:</span><span class="nd">User</span> <span class="nt">RETURN</span> <span class="nt">n</span><span class="o">;</span>
<span class="nt">n</span>
<span class="o">(</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span>

<span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">n</span><span class="o">)</span> <span class="nt">WHERE</span> <span class="nt">n</span><span class="p">.</span><span class="nc">username</span> <span class="o">=</span> <span class="s2">&quot;graham&quot;</span> <span class="nt">RETURN</span> <span class="nt">n</span><span class="o">;</span>
<span class="nt">n</span>
<span class="o">(</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span>

<span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">n</span><span class="o">)</span> <span class="nt">WHERE</span> <span class="nt">n</span><span class="p">:</span><span class="nd">User</span> <span class="nt">AND</span> <span class="nt">n</span><span class="p">.</span><span class="nc">username</span> <span class="o">=</span> <span class="s2">&quot;graham&quot;</span> <span class="nt">RETURN</span> <span class="nt">n</span><span class="o">;</span>
<span class="nt">n</span>
<span class="o">(</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span> <span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span>
</pre></div>


<p>These all return exactly the same as the ones above, but using a different structure that may be more familiar. Where this gets better is when we start to do more complicated matches. For example, we might want all nodes that have a username, but not care what it is:</p>
<div class="highlight"><pre><span></span>neo4j&gt; MATCH (n) WHERE exists(n.username) RETURN n;
n
(:User {username: &quot;graham&quot;})
</pre></div>


<h3>Creating a relationship</h3>
<p>Now that we can create and retrieve Nodes, we want to work with Relationships. After all, that's the entire point of a Graph Database. Not surprisingly, these are also really easy to work with. Firstly though, we'll create some more data to work with:</p>
<div class="highlight"><pre><span></span><span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">CREATE</span> <span class="o">(</span><span class="nt">c</span><span class="p">:</span><span class="nd">Character</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">}</span><span class="o">);</span>
<span class="nt">Added</span> <span class="nt">1</span> <span class="nt">nodes</span><span class="o">,</span> <span class="nt">Set</span> <span class="nt">1</span> <span class="nt">properties</span><span class="o">,</span> <span class="nt">Added</span> <span class="nt">1</span> <span class="nt">labels</span>
</pre></div>


<p>And now that we've got a User node and a Character node, we'll tell the system that the User is the OWNER of the Character.</p>
<div class="highlight"><pre><span></span><span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">u</span><span class="p">:</span><span class="nd">User</span><span class="o">),</span> <span class="o">(</span><span class="nt">c</span><span class="p">:</span><span class="nd">Character</span><span class="o">)</span> <span class="nt">CREATE</span> <span class="o">(</span><span class="nt">u</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="p">:</span><span class="nx">OWNER</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">c</span><span class="o">);</span>
<span class="nt">Created</span> <span class="nt">1</span> <span class="nt">relationships</span>
</pre></div>


<p>There's a lot going on here. Firstly you'll notice that we have both a MATCH and a CREATE command in the same statement. This is a method of chaining the output of one command into the next one. Secondly, you'll notice that the MATCH command is returning two different, distinct nodes. There's no reason not to do this, and you can return as many as you need. Finally, you'll notice the syntax for the CREATE statement is a little bit different to before. In this case, what we are creating is the relationship between to nodes that we've already matched. You'll also see that the CREATE statement re-uses the tags that we gave the nodes in the MATCH statement. This is used by the system to know that these are not new nodes to be created, but existing ones to re-use. As it happens, you can create nodes and relationships all in one go if you desire, simply by defining them in the CREATE instead of re-using them from a MATCH.</p>
<p>You'll note here that the definition of the Relationship is inside square brackets, and has lines on either side. In fact, what we've got here is a directional relationship, which is why the lines look like an arrow. You can draw the arrow either way around, and it will work as expected. You can also leave the arrowhead off altogether and have a non-directional relationship. These are all perfectly valid, and slightly different to each other, so you'll want to make sure you use the correct one for your data.</p>
<h3>Retrieving relationships</h3>
<p>Now that we've got a relationship, we want to make use of it. Lets start with the obvious one - all of the Characters that belong to the User "graham":</p>
<div class="highlight"><pre><span></span><span class="nt">neo4j</span><span class="o">&gt;</span> <span class="nt">MATCH</span> <span class="o">(</span><span class="nt">u</span><span class="p">:</span><span class="nd">User</span> <span class="p">{</span><span class="n">username</span><span class="p">:</span><span class="s2">&quot;graham&quot;</span><span class="p">}</span><span class="o">)</span><span class="nt">-</span><span class="cp">[</span><span class="nx">r</span><span class="p">:</span><span class="nx">OWNER</span><span class="cp">]</span><span class="nt">-</span><span class="o">&gt;(</span><span class="nt">c</span><span class="p">:</span><span class="nd">Character</span><span class="o">)</span> <span class="nt">RETURN</span> <span class="nt">c</span><span class="o">;</span>
<span class="nt">c</span>
<span class="o">(</span><span class="p">:</span><span class="nd">Character</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">}</span><span class="o">)</span>
</pre></div>


<p>It really is as simple as that. We're specifying a MATCH command, where we want to Match a "User" node that has a property "username" equal to "graham". We want to traverse from this node across a Relationship with a label of "OWNER" to the target "Character" nodes, and we want to return the Character nodes. In this case theres only one, but there might be lots more.</p>
<p>All of the filtering that we user before can be used at any part of this match. We've filtered the relationship by label, but can equally do so by properties, and we can do so with WHERE clauses too.</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
        <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="http://twitter.com/grahamcox82"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
              </ul>
            </li>





    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://neo4j.com/" target="_blank">
                Neo4J
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Graham Cox <graham@grahamcox.co.uk>
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://databaseblog.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://databaseblog.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://databaseblog.github.io/theme/js/respond.min.js"></script>

    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-62627767-2']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>